
//  Park NPCs in deArnise Keep

//  Dace SoA

EXTEND_BOTTOM T#DACEP 0 3
IF ~G("RjaliDaceScout",2)
    !G("KeepPlot",0)~ THEN REPLY @0 GOTO RJParkDaceSOA
END

APPEND T#DACEP

IF ~~ THEN BEGIN RJParkDaceSOA
  SAY @1100
  IF ~~ THEN DO ~SetGlobal("RJParkDA","GLOBAL",1)
                 IncrementGlobal("RJCntParked","GLOBAL",1)
                 EscapeAreaMove("AR1304",744,3294,0)~ EXIT
END

IF WEIGHT #-1 ~G("RJParkDA",1)~ THEN BEGIN RJVisitDaceSOA
  SAY @1101
  IF ~~ THEN REPLY @13 EXIT
  IF ~~ THEN REPLY @1102 DO ~
                 SetGlobal("RJParkDA","GLOBAL",0)
                 IncrementGlobal("RJCntParked","GLOBAL",-1)
                 JoinParty()~ EXIT
  IF ~RandomNum(3,1)~ THEN REPLY @9 GOTO RJVDASOA1
  IF ~RandomNum(3,2)~ THEN REPLY @9 GOTO RJVDASOA2
  IF ~RandomNum(3,3)~ THEN REPLY @9 GOTO RJVDASOA3
  IF ~~ THEN REPLY @11 GOTO RJVDASOA4
  IF ~~ THEN REPLY @1116 GOTO RJVDASOA5
  IF ~~ THEN REPLY @8 GOTO RJVDASOA6
END

IF ~~ THEN BEGIN RJVDASOA1
  SAY @1138 = @1139
  IF ~~ THEN REPLY @1140 GOTO RJVDASOA1.1
END

IF ~~ THEN BEGIN RJVDASOA1.1
  SAY @1141 = @1142
  IF ~~ THEN REPLY @1143 EXIT
END

IF ~~ THEN BEGIN RJVDASOA2
  SAY @1144
  IF ~~ THEN REPLY @1170 GOTO RJVDASOA2.1
END

IF ~~ THEN BEGIN RJVDASOA2.1
  SAY @1171
  IF ~~ THEN REPLY @1145 GOTO RJVDASOA2.2
END

IF ~~ THEN BEGIN RJVDASOA2.2
  SAY @1146 = @1147
  IF ~~ THEN REPLY @1148 EXIT
END

IF ~~ THEN BEGIN RJVDASOA3
  SAY @1149 = @1150
  IF ~~ THEN REPLY @1151 EXIT
END

IF ~~ THEN BEGIN RJVDASOA4
  SAY @1127 = @1128 = @1129
  IF ~~ THEN REPLY @1130 EXIT
END

IF ~~ THEN BEGIN RJVDASOA5
  SAY @1117 = @1118 = @1119 = @1120
  IF ~~ THEN REPLY @1121 EXIT
END

IF ~~ THEN BEGIN RJVDASOA6
  SAY @1103 = @1104
  IF ~!PartyGoldGT(1000)~ THEN REPLY @1105 GOTO RJVDASOA6.1
  IF ~PartyGoldGT(1000)~ THEN REPLY @1106 DO ~TakePartyGold(1000)~ GOTO RJVDASOA6.1
END

IF ~~ THEN BEGIN RJVDASOA6.1
  SAY @1107 = @1108
  IF ~~ THEN REPLY @1109 EXIT
END

END

//   Dace ToB

EXTEND_BOTTOM T#DAC25P 7
IF ~G("T#DaceRomanceActive",2)~ THEN REPLY @0 GOTO RJParkDaceTOB
END

APPEND T#DAC25P

IF ~~ THEN BEGIN RJParkDaceTOB
  SAY @1100
  IF ~~ THEN DO ~SetGlobal("RJParkDA","GLOBAL",1)
                 IncrementGlobal("RJCntParked","GLOBAL",1)
                 EscapeAreaMove("AR1304",744,3294,0)~ EXIT
END

IF WEIGHT #-1 ~G("RJParkDA",1)~ THEN BEGIN RJVisitDaceTOB
  SAY @1101
  IF ~G("RJFinalVisit",1) G("RJDAFV",0)~ THEN REPLY @14 GOTO RJVDATOB9
  IF ~~ THEN REPLY @13 EXIT
  IF ~~ THEN REPLY @1102 DO ~
                 SetGlobal("RJParkDA","GLOBAL",0)
                 IncrementGlobal("RJCntParked","GLOBAL",-1)
                 JoinParty()~ EXIT
  IF ~RandomNum(3,1)~ THEN REPLY @9 GOTO RJVDATOB1
  IF ~RandomNum(3,2)~ THEN REPLY @9 GOTO RJVDATOB2
  IF ~RandomNum(3,3)~ THEN REPLY @9 GOTO RJVDATOB3
  IF ~~ THEN REPLY @11 GOTO RJVDATOB4
  IF ~~ THEN REPLY @1122 GOTO RJVDATOB5
  IF ~~ THEN REPLY @8 GOTO RJVDATOB6
END

IF ~~ THEN BEGIN RJVDATOB1
  SAY @1152 = @1153 = @1154
  IF ~~ THEN REPLY @1155 GOTO RJVDATOB1.1
END

IF ~~ THEN BEGIN RJVDATOB1.1
  SAY @1163 = @1164
  IF ~~ THEN REPLY @1165 GOTO RJVDATOB1.2
END

IF ~~ THEN BEGIN RJVDATOB1.2
  SAY @1166 = @1167 = @1168
  IF ~~ THEN REPLY @1169 EXIT
END

IF ~~ THEN BEGIN RJVDATOB2
  SAY @1156 = @1157 = @1158
  IF ~~ THEN REPLY @1159 EXIT
END

IF ~~ THEN BEGIN RJVDATOB3
  SAY @1160 = @1161
  IF ~~ THEN REPLY @1162 EXIT
END

IF ~~ THEN BEGIN RJVDATOB4
  SAY @1131 = @1132 = @1133
  IF ~~ THEN REPLY @1134 EXIT
END

IF ~~ THEN BEGIN RJVDATOB5
  SAY @1123 = @1124 = @1125
  IF ~~ THEN REPLY @1126 EXIT
END

IF ~~ THEN BEGIN RJVDATOB6
  SAY @1110 = @1111 = @1112
  IF ~~ THEN REPLY @1113 GOTO RJVDATOB6.1
END

IF ~~ THEN BEGIN RJVDATOB6.1
  SAY @1114
  IF ~~ THEN REPLY @1115 EXIT
END

IF ~~ THEN BEGIN RJVDATOB9
  SAY @1135 = @1136
  IF ~~ THEN REPLY @1137 DO ~SetGlobal("RJDAFV","GLOBAL",1)~ EXIT
END

END
