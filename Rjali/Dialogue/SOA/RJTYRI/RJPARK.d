
//  Park NPCs in deArnise Keep

//  Tyris SoA

EXTEND_BOTTOM G#TYRISP 6
IF ~G("RjaliTyrisScout",2)
    !G("KeepPlot",0)~ THEN REPLY @0 GOTO RJParkTyrisSOA
END

APPEND G#TYRISP

IF ~~ THEN BEGIN RJParkTyrisSOA
  SAY @1600
  IF ~~ THEN DO ~SetGlobal("RJParkTY","GLOBAL",1)
                 IncrementGlobal("RJCntParked","GLOBAL",1)
                 EscapeAreaMove("AR1306",922,1410,8)~ EXIT
END

IF WEIGHT #-1 ~G("RJParkTY",1)~ THEN BEGIN RJVisitTyrisSOA
  SAY @1601
  IF ~~ THEN REPLY @13 EXIT
  IF ~~ THEN REPLY @1602 DO ~SetGlobal("RJParkTY","GLOBAL",0)
                 IncrementGlobal("RJCntParked","GLOBAL",-1)
                 JoinParty()~ EXIT
  IF ~RandomNum(3,1)~ THEN REPLY @9 GOTO RJVTYSOA1
  IF ~RandomNum(3,2)~ THEN REPLY @9 GOTO RJVTYSOA2
  IF ~RandomNum(3,3)~ THEN REPLY @9 GOTO RJVTYSOA3
  IF ~~ THEN REPLY @11 GOTO RJVTYSOA4
  IF ~~ THEN REPLY @1616 GOTO RJVTYSOA5
  IF ~G("RJParkNE",1)~ THEN REPLY @8 GOTO RJVTYSOA61
  IF ~!G("RJParkNE",1)~ THEN REPLY @8 GOTO RJVTYSOA62
END

IF ~~ THEN BEGIN RJVTYSOA1
  SAY @1620
  IF ~~ THEN REPLY @1621 EXIT
END

IF ~~ THEN BEGIN RJVTYSOA2
  SAY @1620
  IF ~~ THEN REPLY @1622 EXIT
END

IF ~~ THEN BEGIN RJVTYSOA3
  SAY @1623 = @1624 = @1625
  IF ~~ THEN REPLY @1626 EXIT
END

IF ~~ THEN BEGIN RJVTYSOA4
  SAY @1612 = @1613 = @1614
  IF ~~ THEN REPLY @1615 EXIT
END

IF ~~ THEN BEGIN RJVTYSOA5
  SAY @1617 = @1618
  IF ~~ THEN REPLY @1619 EXIT
END

IF ~~ THEN BEGIN RJVTYSOA61
  SAY @1604 = @1605 = @1606
  IF ~~ THEN REPLY @1607 EXIT
END

IF ~~ THEN BEGIN RJVTYSOA62
  SAY @1608 = @1609 = @1610
  IF ~~ THEN REPLY @1611 EXIT
END

END

//   Tyris ToB

EXTEND_BOTTOM G#TRS25P 2
IF ~G("E3FADERomanceActive",2)~ THEN REPLY @0 GOTO RJParkTyrisTOB
END

APPEND G#TRS25P

IF ~~ THEN BEGIN RJParkTyrisTOB
  SAY @1603
  IF ~~ THEN DO ~SetGlobal("RJParkTY","GLOBAL",1)
                 IncrementGlobal("RJCntParked","GLOBAL",1)
                 EscapeAreaMove("AR1306",922,1410,8)~ EXIT
END

IF WEIGHT #-1 ~G("RJParkTY",1)~ THEN BEGIN RJVisitTyrisTOB
  SAY @1601
  IF ~G("RJFinalVisit",1) G("RJTYFV",0)~ THEN REPLY @14 GOTO RJVTYTOB9
  IF ~~ THEN REPLY @13 EXIT
  IF ~~ THEN REPLY @1602 DO ~SetGlobal("RJParkTY","GLOBAL",0)
                 IncrementGlobal("RJCntParked","GLOBAL",-1)
                 JoinParty()~ EXIT
  IF ~RandomNum(3,1)~ THEN REPLY @9 GOTO RJVTYTOB1
  IF ~RandomNum(3,2)~ THEN REPLY @9 GOTO RJVTYTOB2
  IF ~RandomNum(3,3)~ THEN REPLY @9 GOTO RJVTYTOB3
  IF ~~ THEN REPLY @11 GOTO RJVTYTOB4
  IF ~~ THEN REPLY @1647 GOTO RJVTYTOB5
  IF ~G("RJParkNE",1)~ THEN REPLY @8 GOTO RJVTYTOB61
  IF ~!G("RJParkNE",1)~ THEN REPLY @8 GOTO RJVTYTOB62
END

IF ~~ THEN BEGIN RJVTYTOB1
  SAY @1631 = @1632 = @1633 = @1634
  IF ~~ THEN REPLY @1635 EXIT
END

IF ~~ THEN BEGIN RJVTYTOB2
  SAY @1636 = @1637
  IF ~~ THEN REPLY @1638 EXIT
END

IF ~~ THEN BEGIN RJVTYTOB3
  SAY @1627 = @1628 = @1629
  IF ~~ THEN REPLY @1630 EXIT
END

IF ~~ THEN BEGIN RJVTYTOB4
  SAY @1643 = @1644 = @1645
  IF ~~ THEN REPLY @1646 EXIT
END

IF ~~ THEN BEGIN RJVTYTOB5
  SAY @1648 = @1649 = @1650
  IF ~~ THEN EXIT
END

IF ~~ THEN BEGIN RJVTYTOB61
  SAY @1656 = @1657 = @1658 = @1659
  IF ~~ THEN REPLY @1660 EXIT
END

IF ~~ THEN BEGIN RJVTYTOB62
  SAY @1651 = @1652 = @1653 = @1654
  IF ~~ THEN REPLY @1655 EXIT
END

IF ~~ THEN BEGIN RJVTYTOB9
  SAY @1639 = @1640 = @1641
  IF ~~ THEN REPLY @1642 DO ~SetGlobal("RJTYFV","GLOBAL",1)~ EXIT
END

END
